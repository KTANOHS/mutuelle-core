{% extends "base.html" %}
{% load static %}

{% block title %}Test Messagerie Multi-Acteurs{% endblock %}

{% block content %}
<div class="container-fluid py-4">
    <div class="row">
        <div class="col-12">
            <div class="card shadow-lg">
                <div class="card-header bg-primary text-white">
                    <h4 class="mb-0">
                        <i class="fas fa-envelope me-2"></i>Test des Interfaces Messagerie
                    </h4>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-3 mb-4">
                            <div class="card text-center border-primary">
                                <div class="card-body">
                                    <i class="fas fa-user fa-3x text-primary mb-3"></i>
                                    <h5>Membre</h5>
                                    <p class="text-muted">Interface pour les membres</p>
                                    <a href="{% url 'communication:messagerie_membre' %}" class="btn btn-primary">
                                        Tester Messagerie Membre
                                    </a>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 mb-4">
                            <div class="card text-center border-success">
                                <div class="card-body">
                                    <i class="fas fa-shield-alt fa-3x text-success mb-3"></i>
                                    <h5>Assureur</h5>
                                    <p class="text-muted">Interface pour les assureurs</p>
                                    <a href="{% url 'communication:messagerie_assureur' %}" class="btn btn-success">
                                        Tester Messagerie Assureur
                                    </a>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 mb-4">
                            <div class="card text-center border-info">
                                <div class="card-body">
                                    <i class="fas fa-user-md fa-3x text-info mb-3"></i>
                                    <h5>M√©decin</h5>
                                    <p class="text-muted">Interface pour les m√©decins</p>
                                    <a href="{% url 'communication:messagerie_medecin' %}" class="btn btn-info">
                                        Tester Messagerie M√©decin
                                    </a>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 mb-4">
                            <div class="card text-center border-warning">
                                <div class="card-body">
                                    <i class="fas fa-headset fa-3x text-warning mb-3"></i>
                                    <h5>Agent</h5>
                                    <p class="text-muted">Interface pour les agents</p>
                                    <a href="{% url 'communication:messagerie_agent' %}" class="btn btn-warning">
                                        Tester Messagerie Agent
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Test direct du modal -->
                    <div class="card mt-4">
                        <div class="card-header bg-secondary text-white">
                            <h5 class="mb-0">
                                <i class="fas fa-bolt me-2"></i>Test Direct du Modal
                            </h5>
                        </div>
                        <div class="card-body text-center">
                            <p class="mb-3">Testez directement le modal "Nouveau Message" depuis cette page :</p>
                            <button type="button" class="btn btn-primary btn-lg" 
                                    data-bs-toggle="modal" data-bs-target="#nouveauMessageModal">
                                <i class="fas fa-plus me-2"></i>Ouvrir le Modal de Message
                            </button>
                        </div>
                    </div>
                    
                    <div class="alert alert-info mt-4">
                        <h6>Instructions de test:</h6>
                        <ol class="mb-0">
                            <li>Cliquez sur un bouton pour acc√©der √† l'interface correspondante</li>
                            <li>OU testez directement le modal avec le bouton ci-dessus</li>
                            <li>Cliquez sur "Nouveau Message" pour ouvrir le modal</li>
                            <li>S√©lectionnez un destinataire et testez l'envoi</li>
                            <li>V√©rifiez la console du navigateur (F12) pour les logs</li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Inclusion du modal universel -->
{% include "communication/partials/_universal_message_modal.html" %}

<script>
document.addEventListener('DOMContentLoaded', function() {
    console.log('Page de test des messageries initialis√©e');
    
    // V√©rifier que Bootstrap est disponible
    if (typeof bootstrap !== 'undefined') {
        console.log('‚úÖ Bootstrap d√©tect√©');
    } else {
        console.error('‚ùå Bootstrap non d√©tect√©');
    }
    
    // √âcouter l'ouverture du modal
    const modalElement = document.getElementById('nouveauMessageModal');
    if (modalElement) {
        modalElement.addEventListener('show.bs.modal', function() {
            console.log('üéØ Modal ouvert depuis la page de test');
        });
    }
});
</script>
{% endblock %}
