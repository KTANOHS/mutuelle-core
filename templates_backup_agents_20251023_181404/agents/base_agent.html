{% extends "base.html" %}
{% load static %}

{% block title %}Espace Agent - Mutuelle{% endblock %}

{% block extra_css %}
<style>
    .agent-sidebar {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        box-shadow: 0 0 15px rgba(0,0,0,0.1);
    }
    .agent-sidebar .nav-link {
        color: rgba(255,255,255,0.8);
        padding: 12px 20px;
        margin: 4px 0;
        border-radius: 8px;
        transition: all 0.3s ease;
    }
    .agent-sidebar .nav-link:hover,
    .agent-sidebar .nav-link.active {
        background: rgba(255,255,255,0.1);
        color: white;
        transform: translateX(5px);
    }
    .agent-sidebar .nav-link i {
        width: 20px;
        margin-right: 10px;
    }
    .sidebar-header {
        padding: 20px;
        border-bottom: 1px solid rgba(255,255,255,0.1);
        margin-bottom: 10px;
    }
    .notification-badge {
        background: #ff4757;
        color: white;
        border-radius: 50%;
        padding: 2px 6px;
        font-size: 0.7rem;
        margin-left: auto;
    }
</style>
{% endblock %}

{% block sidebar %}
<!-- Sidebar spécifique à l'agent -->
<nav class="agent-sidebar">
    <div class="sidebar-header">
        <h5 class="text-white mb-0">
            <i class="fas fa-user-shield"></i>
            Espace Agent
        </h5>
        <small class="text-white-50">{{ user.get_full_name|default:user.username }}</small>
    </div>
    
    <ul class="nav flex-column">
        <li class="nav-item">
            <a class="nav-link {% if request.resolver_match.url_name == 'agent_dashboard' %}active{% endif %}" 
               href="{% url 'agent_dashboard' %}">
                <i class="fas fa-tachometer-alt"></i>
                Tableau de Bord
            </a>
        </li>
        
        <li class="nav-item">
            <a class="nav-link {% if 'membres' in request.resolver_match.url_name %}active{% endif %}" 
               href="{% url 'liste_membres_agent' %}">
                <i class="fas fa-users"></i>
                Gestion des Membres
            </a>
        </li>
        
        <li class="nav-item">
            <a class="nav-link {% if 'soin' in request.resolver_match.url_name %}active{% endif %}" 
               href="{% url 'creer_bon_soin' %}">
                <i class="fas fa-file-medical"></i>
                Bons de Soins
            </a>
        </li>
        
        <li class="nav-item">
            <a class="nav-link {% if 'cotisation' in request.resolver_match.url_name %}active{% endif %}" 
               href="{% url 'verification_cotisation' %}">
                <i class="fas fa-check-circle"></i>
                Vérification Cotisations
            </a>
        </li>
        
        <li class="nav-item">
            <a class="nav-link {% if 'notifications' in request.resolver_match.url_name %}active{% endif %}" 
               href="{% url 'agent_notifications' %}">
                <i class="fas fa-bell"></i>
                Notifications
                {% if unread_notifications_count %}
                <span class="notification-badge">{{ unread_notifications_count }}</span>
                {% endif %}
            </a>
        </li>
        
        <li class="nav-item mt-4">
            <a class="nav-link text-warning" href="{% url 'logout' %}">
                <i class="fas fa-sign-out-alt"></i>
                Déconnexion
            </a>
        </li>
    </ul>
</nav>
{% endblock %}

{% block content %}
<!-- Le contenu spécifique à chaque page sera inséré ici -->
<div class="container-fluid py-4">
    {% block agent_content %}
    {% endblock %}
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Scripts spécifiques à l'agent
    $(document).ready(function() {
        // Animation des liens de la sidebar
        $('.nav-link').hover(
            function() {
                $(this).addClass('shadow-sm');
            },
            function() {
                $(this).removeClass('shadow-sm');
            }
        );
        
        // Auto-dismiss alerts après 5 secondes
        setTimeout(function() {
            $('.alert').fadeTo(500, 0).slideUp(500, function(){
                $(this).remove(); 
            });
        }, 5000);
    });
</script>
{% endblock %}