# Generated by Django 5.2.7 on 2025-12-05 07:17

import django.core.validators
import django.db.models.deletion
import django.utils.timezone
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('assureur', '0001_initial'),
        ('membres', '0001_initial'),
        ('soins', '0001_initial'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='EtablissementMedical',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nom', models.CharField(max_length=200)),
                ('type_etablissement', models.CharField(choices=[('HOPITAL', 'Hôpital'), ('CLINIQUE', 'Clinique'), ('CABINET', 'Cabinet médical'), ('DISPENSAIRE', 'Dispensaire'), ('CENTRE_SANTE', 'Centre de santé')], max_length=20)),
                ('adresse', models.TextField()),
                ('telephone', models.CharField(max_length=20)),
                ('email', models.EmailField(blank=True, max_length=254)),
                ('ville', models.CharField(max_length=100)),
                ('pays', models.CharField(default="Côte d'Ivoire", max_length=100)),
                ('actif', models.BooleanField(default=True)),
            ],
            options={
                'verbose_name': 'Établissement médical',
                'verbose_name_plural': 'Établissements médicaux',
                'ordering': ['nom'],
            },
        ),
        migrations.CreateModel(
            name='MaladieChronique',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nom', models.CharField(max_length=200)),
                ('code_cim', models.CharField(blank=True, max_length=10, null=True)),
                ('description', models.TextField(blank=True)),
                ('recommandations_generales', models.TextField(blank=True)),
                ('actif', models.BooleanField(default=True)),
            ],
            options={
                'verbose_name': 'Maladie chronique',
                'verbose_name_plural': 'Maladies chroniques',
                'db_table': 'maladies_chroniques',
                'ordering': ['nom'],
            },
        ),
        migrations.CreateModel(
            name='Medicament',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nom', models.CharField(max_length=200, verbose_name='Nom commercial')),
                ('dci', models.CharField(blank=True, max_length=200, verbose_name='DCI')),
                ('forme_galenique', models.CharField(blank=True, max_length=100, verbose_name='Forme galénique')),
                ('dosage', models.CharField(blank=True, max_length=100, verbose_name='Dosage')),
                ('classe_therapeutique', models.CharField(blank=True, max_length=200, verbose_name='Classe thérapeutique')),
                ('est_remboursable', models.BooleanField(default=True, verbose_name='Remboursable')),
            ],
            options={
                'verbose_name': 'Médicament',
                'verbose_name_plural': 'Médicaments',
                'ordering': ['nom'],
            },
        ),
        migrations.CreateModel(
            name='SpecialiteMedicale',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nom', models.CharField(max_length=100, unique=True)),
                ('description', models.TextField(blank=True)),
                ('actif', models.BooleanField(default=True)),
            ],
            options={
                'verbose_name': 'Spécialité médicale',
                'verbose_name_plural': 'Spécialités médicales',
                'ordering': ['nom'],
            },
        ),
        migrations.CreateModel(
            name='Medecin',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('numero_ordre', models.CharField(max_length=50, unique=True, verbose_name="Numéro d'ordre des médecins")),
                ('telephone_pro', models.CharField(max_length=20, verbose_name='Téléphone professionnel')),
                ('email_pro', models.EmailField(blank=True, max_length=254, verbose_name='Email professionnel')),
                ('annees_experience', models.PositiveIntegerField(default=0, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(60)])),
                ('tarif_consultation', models.DecimalField(decimal_places=2, default=0, max_digits=10, verbose_name='Tarif consultation (FCFA)')),
                ('actif', models.BooleanField(default=True)),
                ('disponible', models.BooleanField(default=True)),
                ('date_inscription', models.DateTimeField(auto_now_add=True)),
                ('date_derniere_modif', models.DateTimeField(auto_now=True)),
                ('horaires_travail', models.JSONField(blank=True, default=dict, help_text='Horaires de travail au format JSON')),
                ('diplome_verifie', models.BooleanField(default=False)),
                ('cv_document', models.FileField(blank=True, null=True, upload_to='medecins/cv/', verbose_name='CV')),
                ('etablissement', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='medecins', to='medecin.etablissementmedical')),
                ('user', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='medecin_profile', to=settings.AUTH_USER_MODEL)),
                ('specialite', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='medecins', to='medecin.specialitemedicale')),
            ],
            options={
                'verbose_name': 'Médecin',
                'verbose_name_plural': 'Médecins',
                'ordering': ['user__last_name', 'user__first_name'],
            },
        ),
        migrations.CreateModel(
            name='Consultation',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('date_consultation', models.DateField()),
                ('heure_consultation', models.TimeField(blank=True, null=True)),
                ('duree', models.PositiveIntegerField(default=30, help_text='Durée en minutes')),
                ('type_consultation', models.CharField(choices=[('GENERALE', 'Consultation générale'), ('SPECIALISEE', 'Consultation spécialisée'), ('SUIVI', 'Consultation de suivi'), ('URGENCE', 'Urgence')], default='GENERALE', max_length=20)),
                ('statut', models.CharField(choices=[('PLANIFIEE', 'Planifiée'), ('EN_COURS', 'En cours'), ('TERMINEE', 'Terminée'), ('ANNULEE', 'Annulée')], default='PLANIFIEE', max_length=20)),
                ('symptomes', models.TextField(blank=True, help_text='Symptômes décrits par le patient')),
                ('notes', models.TextField(blank=True, help_text='Notes du médecin')),
                ('diagnostic', models.TextField(blank=True, help_text='Diagnostic établi')),
                ('traitement_prescrit', models.TextField(blank=True, help_text='Traitement prescrit')),
                ('motifs', models.TextField(blank=True, help_text='Motifs de la consultation')),
                ('recommandations', models.TextField(blank=True, help_text='Recommandations')),
                ('date_creation', models.DateTimeField(auto_now_add=True)),
                ('date_modification', models.DateTimeField(auto_now=True)),
                ('membre', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='consultations', to='membres.membre')),
                ('medecin', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='consultations', to='medecin.medecin')),
            ],
            options={
                'verbose_name': 'Consultation',
                'verbose_name_plural': 'Consultations',
                'ordering': ['-date_consultation'],
            },
        ),
        migrations.CreateModel(
            name='BonDeSoin',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('numero', models.CharField(max_length=50, unique=True)),
                ('date_soin', models.DateField()),
                ('date_realisation', models.DateField(blank=True, null=True)),
                ('cout_estime', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('cout_reel', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('taux_prise_charge', models.DecimalField(decimal_places=2, default=100, max_digits=5)),
                ('statut', models.CharField(choices=[('BROUILLON', 'Brouillon'), ('EN_ATTENTE', 'En attente de validation'), ('VALIDE', 'Validé'), ('REFUSE', 'Refusé'), ('UTILISE', 'Utilisé')], default='BROUILLON', max_length=20)),
                ('diagnostic', models.TextField(blank=True)),
                ('observations', models.TextField(blank=True)),
                ('motif_refus', models.TextField(blank=True)),
                ('duree_sejour', models.PositiveIntegerField(default=0, help_text='Durée en jours si hospitalisation')),
                ('date_validation', models.DateTimeField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('created_by', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='bons_soin_crees', to=settings.AUTH_USER_MODEL)),
                ('patient', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='bons_soin', to='membres.membre')),
                ('type_soin', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='bons_soin', to='soins.typesoin')),
                ('valide_par', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='bons_soin_valides', to=settings.AUTH_USER_MODEL)),
                ('consultation', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='bons_soin', to='medecin.consultation')),
                ('medecin', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='bons_soin', to='medecin.medecin')),
            ],
            options={
                'verbose_name': 'Bon de soin',
                'verbose_name_plural': 'Bons de soin',
                'ordering': ['-date_soin', '-created_at'],
            },
        ),
        migrations.CreateModel(
            name='AvisMedecin',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('note', models.PositiveIntegerField(choices=[(1, '1 - Très mauvais'), (2, '2 - Mauvais'), (3, '3 - Moyen'), (4, '4 - Bon'), (5, '5 - Excellent')])),
                ('commentaire', models.TextField(blank=True)),
                ('date_creation', models.DateTimeField(auto_now_add=True)),
                ('approuve', models.BooleanField(default=False)),
                ('membre', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='avis_medecins', to='membres.membre')),
                ('medecin', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='avis', to='medecin.medecin')),
            ],
            options={
                'verbose_name': 'Avis médecin',
                'verbose_name_plural': 'Avis médecins',
                'ordering': ['-date_creation'],
            },
        ),
        migrations.CreateModel(
            name='Ordonnance',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('numero', models.CharField(max_length=50, unique=True, verbose_name="Numéro d'ordonnance")),
                ('date_prescription', models.DateField(default=django.utils.timezone.now)),
                ('date_expiration', models.DateField(help_text="Date d'expiration de l'ordonnance")),
                ('date_creation', models.DateTimeField(auto_now_add=True)),
                ('date_modification', models.DateTimeField(auto_now=True)),
                ('type_ordonnance', models.CharField(choices=[('MEDICAMENTS', 'Médicaments'), ('ANALYSES', 'Analyses médicales'), ('IMAGERIE', 'Imagerie médicale'), ('SOINS', 'Soins infirmiers'), ('AUTRE', 'Autre')], default='MEDICAMENTS', max_length=20)),
                ('diagnostic', models.TextField(blank=True, help_text='Diagnostic justifiant la prescription')),
                ('medicaments', models.TextField(help_text='Liste des médicaments prescrits')),
                ('posologie', models.TextField(help_text='Posologie détaillée')),
                ('duree_traitement', models.PositiveIntegerField(default=7, help_text='Durée du traitement en jours')),
                ('renouvelable', models.BooleanField(default=False)),
                ('nombre_renouvellements', models.PositiveIntegerField(default=0)),
                ('renouvellements_effectues', models.PositiveIntegerField(default=0)),
                ('statut', models.CharField(choices=[('ACTIVE', 'Active'), ('EXPIREE', 'Expirée'), ('ANNULEE', 'Annulée'), ('UTILISEE', 'Utilisée'), ('EN_ATTENTE_VALIDATION', 'En attente de validation')], default='EN_ATTENTE_VALIDATION', max_length=25)),
                ('est_urgent', models.BooleanField(default=False)),
                ('notes', models.TextField(blank=True, help_text='Notes complémentaires')),
                ('partage_effectue', models.BooleanField(default=False, verbose_name='Partage automatique effectué')),
                ('assureur', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='ordonnances_assureur', to='assureur.assureur', verbose_name='Assureur du patient')),
                ('consultation', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='ordonnances_consultation', to='medecin.consultation')),
                ('medecin', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='ordonnances_prescrites', to=settings.AUTH_USER_MODEL, verbose_name='Médecin prescripteur')),
                ('patient', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='ordonnances_medecin', to='membres.membre')),
            ],
            options={
                'verbose_name': 'Ordonnance Médecin',
                'verbose_name_plural': 'Ordonnances Médecin',
                'ordering': ['-date_prescription', '-date_creation'],
                'permissions': [('view_ordonnance_membre', 'Peut voir les ordonnances en tant que membre'), ('view_ordonnance_assureur', "Peut voir les ordonnances en tant qu'assureur"), ('view_ordonnance_pharmacien', 'Peut voir les ordonnances en tant que pharmacien')],
            },
        ),
        migrations.CreateModel(
            name='ProgrammeAccompagnement',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('date_debut', models.DateField()),
                ('date_fin_prevue', models.DateField(blank=True, null=True)),
                ('objectifs_therapeutiques', models.TextField()),
                ('protocole_suivi', models.TextField(help_text='Protocole de suivi détaillé')),
                ('statut', models.CharField(choices=[('actif', 'Actif'), ('suspendu', 'Suspendu'), ('termine', 'Terminé'), ('abandon', 'Abandonné')], default='actif', max_length=20)),
                ('observations', models.TextField(blank=True)),
                ('frequence_controle', models.PositiveIntegerField(default=30, help_text='Jours entre chaque contrôle')),
                ('prochain_controle', models.DateField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('maladie', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='medecin.maladiechronique')),
                ('medecin_referent', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='programmes_medecin', to=settings.AUTH_USER_MODEL)),
                ('patient', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='membres.membre')),
                ('pharmacien_referent', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='programmes_pharmacien', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': "Programme d'accompagnement",
                'verbose_name_plural': "Programmes d'accompagnement",
                'db_table': 'programmes_accompagnement',
                'ordering': ['-date_debut'],
            },
        ),
        migrations.CreateModel(
            name='ObjectifTherapeutique',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('description', models.TextField()),
                ('echeance', models.DateField(blank=True, null=True)),
                ('priorite', models.CharField(choices=[('elevee', 'Élevée'), ('moyenne', 'Moyenne'), ('faible', 'Faible')], default='moyenne', max_length=20)),
                ('statut', models.CharField(choices=[('en_cours', 'En cours'), ('atteint', 'Atteint'), ('non_atteint', 'Non atteint'), ('reporte', 'Reporté')], default='en_cours', max_length=20)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('programme', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='objectifs', to='medecin.programmeaccompagnement')),
            ],
            options={
                'verbose_name': 'Objectif thérapeutique',
                'verbose_name_plural': 'Objectifs thérapeutiques',
                'db_table': 'objectifs_therapeutiques',
                'ordering': ['priorite', 'echeance'],
            },
        ),
        migrations.CreateModel(
            name='AlerteSuivi',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('type_alerte', models.CharField(choices=[('controle_retard', 'Contrôle en retard'), ('observance_basse', 'Observance basse'), ('parametre_anormal', 'Paramètre anormal'), ('rdv_manque', 'Rendez-vous manqué'), ('pharmacie_avis', 'Avis pharmacien requis')], max_length=50)),
                ('severite', models.CharField(choices=[('basse', 'Basse'), ('moyenne', 'Moyenne'), ('haute', 'Haute'), ('critique', 'Critique')], default='moyenne', max_length=20)),
                ('message', models.TextField()),
                ('date_creation', models.DateTimeField(auto_now_add=True)),
                ('date_resolution', models.DateTimeField(blank=True, null=True)),
                ('resolue_par', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
                ('programme', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='alertes', to='medecin.programmeaccompagnement')),
            ],
            options={
                'verbose_name': 'Alerte suivi',
                'verbose_name_plural': 'Alertes suivi',
                'db_table': 'alertes_suivi',
                'ordering': ['-date_creation'],
            },
        ),
        migrations.CreateModel(
            name='SuiviPatient',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('type_suivi', models.CharField(choices=[('consultation', 'Consultation médicale'), ('teleconsultation', 'Téléconsultation'), ('pharmacie', 'Visite pharmacie'), ('appel', 'Appel téléphonique'), ('message', 'Message'), ('automesure', 'Auto-mesure')], max_length=20)),
                ('date_suivi', models.DateTimeField(default=django.utils.timezone.now)),
                ('tension_arterielle', models.CharField(blank=True, max_length=20)),
                ('glycemie', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('poids', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('symptomes_observes', models.TextField(blank=True)),
                ('observance_traitement', models.CharField(blank=True, choices=[('excellente', 'Excellente (>90%)'), ('bonne', 'Bonne (70-90%)'), ('moyenne', 'Moyenne (50-70%)'), ('mauvaise', 'Mauvaise (<50%)')], max_length=20)),
                ('observations', models.TextField()),
                ('actions_prises', models.TextField()),
                ('recommendations', models.TextField(blank=True)),
                ('prochain_rdv', models.DateField(blank=True, null=True)),
                ('transmission_pharmacien', models.BooleanField(default=False)),
                ('notes_pharmacien', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('intervenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL)),
                ('programme', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='suivis', to='medecin.programmeaccompagnement')),
            ],
            options={
                'verbose_name': 'Suivi patient',
                'verbose_name_plural': 'Suivis patients',
                'db_table': 'suivis_patients',
                'ordering': ['-date_suivi'],
            },
        ),
        migrations.CreateModel(
            name='DisponibiliteMedecin',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('jour_semaine', models.IntegerField(choices=[(0, 'Lundi'), (1, 'Mardi'), (2, 'Mercredi'), (3, 'Jeudi'), (4, 'Vendredi'), (5, 'Samedi'), (6, 'Dimanche')])),
                ('heure_debut', models.TimeField()),
                ('heure_fin', models.TimeField()),
                ('actif', models.BooleanField(default=True)),
                ('medecin', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='disponibilites', to='medecin.medecin')),
            ],
            options={
                'verbose_name': 'Disponibilité médecin',
                'verbose_name_plural': 'Disponibilités médecins',
                'ordering': ['medecin', 'jour_semaine'],
                'unique_together': {('medecin', 'jour_semaine')},
            },
        ),
        migrations.AddIndex(
            model_name='consultation',
            index=models.Index(fields=['medecin', 'date_consultation'], name='medecin_con_medecin_70a6c9_idx'),
        ),
        migrations.AddIndex(
            model_name='consultation',
            index=models.Index(fields=['membre', 'date_consultation'], name='medecin_con_membre__6cca85_idx'),
        ),
        migrations.AddIndex(
            model_name='consultation',
            index=models.Index(fields=['statut'], name='medecin_con_statut_1ea324_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='avismedecin',
            unique_together={('medecin', 'membre')},
        ),
        migrations.AddIndex(
            model_name='ordonnance',
            index=models.Index(fields=['numero'], name='medecin_ord_numero_5e2baa_idx'),
        ),
        migrations.AddIndex(
            model_name='ordonnance',
            index=models.Index(fields=['patient', 'date_prescription'], name='medecin_ord_patient_b13348_idx'),
        ),
        migrations.AddIndex(
            model_name='ordonnance',
            index=models.Index(fields=['medecin', 'date_prescription'], name='medecin_ord_medecin_6d9728_idx'),
        ),
        migrations.AddIndex(
            model_name='ordonnance',
            index=models.Index(fields=['assureur', 'statut'], name='medecin_ord_assureu_933a44_idx'),
        ),
        migrations.AddIndex(
            model_name='ordonnance',
            index=models.Index(fields=['statut', 'date_expiration'], name='medecin_ord_statut_dbc52a_idx'),
        ),
        migrations.AddConstraint(
            model_name='ordonnance',
            constraint=models.CheckConstraint(condition=models.Q(('date_expiration__gte', models.F('date_prescription'))), name='date_expiration_after_prescription'),
        ),
        migrations.AddIndex(
            model_name='medecin',
            index=models.Index(fields=['numero_ordre'], name='medecin_med_numero__183d00_idx'),
        ),
        migrations.AddIndex(
            model_name='medecin',
            index=models.Index(fields=['actif', 'disponible'], name='medecin_med_actif_0972c7_idx'),
        ),
        migrations.AddIndex(
            model_name='medecin',
            index=models.Index(fields=['specialite'], name='medecin_med_special_45d818_idx'),
        ),
    ]
